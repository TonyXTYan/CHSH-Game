<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PHB6HZJJ7X"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-PHB6HZJJ7X');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CHSH Game - Participant</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="connection-status" id="connectionStatus"></div>
    <div class="container">
        <h1 id="gameHeader">CHSH Game</h1>
        <div id="statusMessage" class="status-message info" style="border: 2px solid #1565C0;">Connecting to server...</div>
        
        <!-- Team Creation/Join Section -->
        <div id="teamSection">
            <h2 id="teamStatusHeader">Team Up!</h2>
            
            <!-- Create Team Form -->
            <div id="createTeamSection">
                <h3>Create a New Team</h3>
                <div class="form-group">
                    <input type="text" id="teamNameInput" placeholder="Enter Team Name">
                </div>
                <button id="createTeamBtn">Create Team</button>
            </div>
            
            <!-- Join Team Section -->
            <div id="joinTeamSection">
                <!-- Active Teams Section -->
                <h3>Join an Existing Team</h3>
                <div id="availableTeams" class="team-list">
                    <div class="team-item">No active teams available to join currently.</div>
                </div>

                <!-- Inactive Teams Section -->
<div class="collapsible-section">
    <div class="collapsible-header">
        <h3 class="toggle-target">Reactivate Previous Team</h3>
        <span class="toggle-indicator">‚ñº</span>
    </div>
    <div id="inactiveTeams" class="team-list" style="display: none; border: 2px dashed #FFC107; padding: 10px;">
        <div class="team-item inactive">No inactive teams available. Reactivate a team to join!</div>
    </div>
</div>
            </div>
        </div>
        
        <!-- Question Section (Initially Hidden) -->
        <div id="questionSection" class="hidden">
            <div class="question-container">
                <div class="question"><span id="questionItem"></span></div>
                <div class="answer-buttons">
                    <button id="trueBtn" class="answer-button true-button">True</button>
                    <button id="falseBtn" class="answer-button false-button">False</button>
                </div>
            </div>
            <div id="waitingMessage" class="status-message info">
                Waiting for partner to answer...
            </div>
        </div>
        
        <!-- Hint Sections -->
        <div class="hint-sections" style="margin-top: 30px;">
            <!-- Game Rules Section -->
            <div class="collapsible-section">
                <div class="collapsible-header">
                    <h3 class="toggle-target">Game Rules</h3>
                    <span class="toggle-indicator">‚ñº</span>
                </div>
                <div class="hint-content" style="display: none; border: 2px solid #9900ff; padding: 15px; margin-top: 10px; border-radius: 5px; background-color: #f9f9f9;">
                    <ul style="margin: 0; padding-left: 20px;">
                        <li>Discuss and agree on a shared strategy before the game starts.</li>
                        <li><strong>No</strong> communicate during the game.</li>
                        <li>Focus on <strong>consistency</strong> rather than <strong>randomness</strong>.</li>
                        <li>Watch the dashboard to see your teams' progress.</li>
                    </ul>
                </div>
            </div>

            <!-- Winning Conditions Section -->
            <div class="collapsible-section" style="margin-top: 15px;">
                <div class="collapsible-header">
                    <h3 class="toggle-target">Winning Conditions</h3>
                    <span class="toggle-indicator">‚ñº</span>
                </div>
                <div class="hint-content" style="display: none; border: 2px solid #9900ff; padding: 15px; margin-top: 10px; border-radius: 5px; background-color: #f9f9f9;">
                    <div style="margin-bottom: 15px;">
                        <strong>üéØ Best Balanced ‚èê‚ü®Tr‚ü©‚èê (Consistency):</strong>
                        <ul style="margin: 5px 0; padding-left: 20px;">
                            <li>If you and your partner are asked the <strong>same question</strong> (A/A, B/B, X/X, or Y/Y), aim to give the <strong>same answer</strong> (True/True or False/False).</li>
                            <li>To achieve balance, your answers should be  <strong>50% True</strong> and <strong>50% False</strong>.</li>
                            <li>The score is computed as:
                                <ul style="margin: 5px 0; padding-left: 20px;">
                                    <li><strong>‚ü®Tr‚ü© = Trace / 4</strong>: ¬±1 if teammates always agree, 0 if always disagree.</li>
                                    <li><strong>Balance</strong> = 1 if your answers are evenly split between True and False, 0 if always the same.</li>
                                    <li><strong>Final score</strong>:  
                                        <code>Balanced |‚ü®Tr‚ü©| = 0.5 √ó (Balance + |‚ü®Tr‚ü©|)</code>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div>
                        <strong>üèÜ Best CHSH (Correlation):</strong>
                        <ul style="margin: 5px 0; padding-left: 20px;">
                            <li>If one of you receives <strong>B</strong> and the other <strong>Y</strong>, you should try to give <strong>different answers</strong> (one True, one False).</li>
                            <li>For all other question combinations, you should give the <strong>same answer</strong> as much as possible.</li>
                            <li>The maximum possible value for CHSH is 4</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="session-info" id="sessionInfo">Session ID: <span class="session-id"></span></div>
    </div>

    <script src="https://cdn.socket.io/4.6.0/socket.io.min.js"></script>
    <script src="socket-handlers.js"></script>
    <script src="app.js"></script>
</body>
</html>
